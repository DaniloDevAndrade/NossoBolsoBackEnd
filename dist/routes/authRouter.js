"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.authRouter = void 0;
const express_1 = require("express");
const AuthControllers_1 = require("../controllers/AuthControllers");
const auth_rate_limit_1 = require("../middlewares/auth-rate-limit");
const auth_middleware_1 = require("../middlewares/auth-middleware");
const MeControllers_1 = require("../controllers/MeControllers");
const authRouter = (0, express_1.Router)();
exports.authRouter = authRouter;
const AuthController = new AuthControllers_1.AuthControllers();
authRouter.post('/register', auth_rate_limit_1.authTightLimiter, AuthController.register);
authRouter.post('/register/verify', auth_rate_limit_1.authTightLimiter, AuthController.verifyRegister);
authRouter.post('/register/resend-code', auth_rate_limit_1.authTightLimiter, AuthController.resendRegisterCode);
authRouter.post('/register/change-number', auth_rate_limit_1.authTightLimiter, AuthController.changeNumberRegister);
authRouter.post('/login', auth_rate_limit_1.authTightLimiter, AuthController.login);
authRouter.post('/login/verify', auth_rate_limit_1.authTightLimiter, AuthController.verifyLogin);
authRouter.post('/login/resend-code', auth_rate_limit_1.authTightLimiter, AuthController.resendLoginCode);
authRouter.post('/password/forgot', auth_rate_limit_1.authTightLimiter, AuthController.forgotPassword);
authRouter.post('/password/reset/verify', auth_rate_limit_1.authTightLimiter, AuthController.resetPasswordVerify);
authRouter.post('/password/reset/resend', auth_rate_limit_1.authTightLimiter, AuthController.resendResetPasswordCode);
authRouter.post('/password/reset', auth_rate_limit_1.authTightLimiter, AuthController.resetPassword);
authRouter.get('/logout', auth_rate_limit_1.authTightLimiter, auth_middleware_1.authMiddleware, AuthController.logout);
authRouter.get("/me", auth_middleware_1.authMiddleware, MeControllers_1.me);
